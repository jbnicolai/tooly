/**
 * tooly - version 0.0.3 (built: 2014-10-01)
 * js utility functions
 * https://github.com/Lokua/tooly.git
 * Copyright (c) 2014 Joshua Kleckner
 * Licensed under the MIT license.
 * http://www.opensource.org/licenses/MIT
 */

!function(a,b){"function"==typeof define&&define.amd?define("tooly",[],function(){return a.returnExportsGlobal=b()}):"object"==typeof exports?module.exports=b():a.tooly=b()}(this,function(){var a=function(){function b(a,b){return a={}.toString.call(a).match(/\s([a-zA-Z]+)/)[1].toLowerCase(),b?a===b.toLowerCase():a}function c(a){return new RegExp("\\s*"+a+"\\s*(![\\w\\W])?","g")}function d(a,c,d){if("array"===b(c)){for(var e,f=0,g=a.length;g>f;f++)e=d(a[f],c);return e}}function e(a,c,d){if("array"===b(a))for(var e=0,f=a.length;f>e;e++)d(a[e],c)}function f(a,b,c){for(var d=a.className.split(j),e=0,f=d.length;f>e;e++)if(d[e].match(c)==b)return!0;return!1}function g(b,c){i(b)||(b=a.select(b)),b.innerHTML=c+b.innerHTML}function h(b,c){i(b)||(b=a.select(b)),b.innerHTML+=c}function i(a){return a&&(1===a.nodeType||9===a.nodeType)}var j=/\s+/;return{hasClass:function(d,e){if(b(d,"array"))for(var g=c(e),h=0,j=d.length;j>h;h++){var k=i(d[h])?d[h]:a.select(d[h]);if(f(k,e,g))return!0}return!1},addClass:function(c,f){return b(c,"array")?e(c,f,a.addClass):i(c)?c.className+=" "+f:c=a.select(c),d(c,f,a.addClass),a},removeClass:function(f,g){return b(f,"array")?e(f,g,a.removeClass):i(f)?f.className=f.className.replace(c(g)," "):f=a.select(f),d(f,g,a.removeClass),a},prepend:function(c,d){return b(c,"array")?(e(c,d,g),a):(g(c,d),a)},append:function(c,d){return b(c,"array")?(e(c,d,h),a):(h(c,d),a)},html:function(c,d){if(1===arguments.length)return"array"===b(c)&&i(c[0])?c[0].innerHTML:i(c)?c.innerHTML:a.select(c).innerHTML;if(!i(c)){if("array"===b(c)){for(var e=0,f=c.length;f>e;e++)i(c[e])?c[e].innerHTML=d:(c[e]=a.select(c[e]),c[e].innerHTML=d);return a}return a.select(c).innerHTML=d,a}return c.innerHTML=d,a},select:function(a,b){return(b||document).querySelector(a)},sel:function(b,c){return a.select(b,c)},selectAll:function(a,b){for(var c=(b||document).querySelectorAll(a),d=[],e=0,f=c.length;f>e;e++)d[e]=c[e];return d},selAll:function(b,c){return a.selectAll(b,c)},parent:function(b){return i(b)||(b=a.select(b)),null!=b?b.parentNode:null},children:function(b){return i(b)||(b=a.select(b)),null!=b?function(){for(var a=b.children,c=[],d=0,e=a.length;e>d;d++)c.push(a.item(d));return c}():null},css:function(c,d){var e=function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a.style[c]=b[c])};if(b(c,"array")){if(3===arguments.length){for(var f=0,g=c.length;g>f;f++)c[f].style[arguments[1]]=arguments[2];return a}for(var f=0,g=c.length;g>f;f++)e(c[f],d);return a}return i(c)||(c=a.select(c)),3===arguments.length?c.style[arguments[1]]=arguments[2]:e(c,d),a},Selector:function(b){return this instanceof a.Selector?(this.el=a.selectAll(b),this):new a.Selector(b)},construct:function(a,c){function d(){return"array"===b(c)?a.apply(this,c):a.call(this,c)}return d.prototype=a.prototype,new d},extend:function(){var c,d,e,f,g,h,i=arguments[0]||{},j=1,k=arguments.length,l=!1;for("boolean"===b(i)&&(l=i,i=arguments[1]||{},j=2),"object"!==b(i)&&"function"!==b(i)&&(i={});k>j;j++)if(c=arguments[j],null!=c){"string"===b(c)&&(c=c.split(""));for(d in c)e=i[d],f=c[d],i!==f&&(l&&f&&(a.isHash(f)||(g="array"===b(f)))?(g?(g=!1,h=e&&"array"===b(e)?e:[]):h=e&&a.isHash(e)?e:{},i[d]=a.extend(l,h,f)):"undefined"!=typeof f&&(i[d]=f))}return i},fromPrototype:function(b,c){var d,e=a.objectCreate(b);for(d in c)c.hasOwnProperty(d)&&(e[d]=c[d]);return e},fromProto:function(b,c){return a.fromPrototype(b,c)},inherit:function(a,b,c){b.prototype=new a,b.prototype.constructor=b;for(var d in c)c.hasOwnProperty(d)&&(b.prototype[d]=c[d])},isHash:function(a){return"object"===b(a)&&a.constructor===Object&&!a.nodeType&&!a.setInterval},objectCreate:function(a){var b=function(){};return b.prototype=a,new b},propCount:function(a){var b,c=0;for(b in a)a.hasOwnProperty(b)&&c++;return c},propsOf:function(a){var b,c=[];for(b in a)a.hasOwnProperty(b)&&c.push(b);return c},getJSON:function(b,c,d){a.get(b,"json",c,d)},get:function(a,b,c,d){var e=new XMLHttpRequest;e.open("get",a,3===arguments.length?!0:d),e.reponseType=b,e.onload=function(){4==e.readyState&&200==e.status&&c(e.response)},e.send()},endsWith:function(a,b){return-1!==a.indexOf(b,a.length-b.length)},format:function(a){var b=Array.prototype.slice.call(arguments,1);return a.replace(/{(\d+)}/g,function(a,c){return"undefined"!=typeof b[c]?b[c]:a})},formatTime:function(a){var b=Math.floor(a/3600),c=Math.floor((a-3600*b)/60),d=Math.floor(a-3600*b-60*c);return 10>b&&(b="0"+b),10>c&&(c="0"+c),10>d&&(d="0"+d),b+":"+c+":"+d},repeat:function(a,b){for(var c="",d=0;b>d;d++)c+=a;return c},scale:function(a,b,c,d,e){return(a-b)*(e-d)/(c-b)+d},sliceRel:function(a,b,c){var d=!1;return"/"===a.slice(-1)&&(d=!0,a=a.slice(0,-1)),a=a.slice(a.lastIndexOf("/")+1),d&&c&&(a=a.concat("/")),b&&(a="/"+a),a},extension:function(a){return a.substring(a.lastIndexOf(".")+1)},ext:function(b){return a.extension(b)},stripExtension:function(a){return a.substring(0,a.lastIndexOf("."))},stripExt:function(b){return a.stripExtension(b)},shit:function(a){console.error("shitError - something is fucking shit up: "+a)},toType:function(){return b(arguments)},type:function(){return b(arguments)},"typeof":function(){return b(arguments)},Handler:function(b){return this instanceof a.Handler?(this.context=b||this,this.handlers=this.context.handlers={},this):new a.Handler(b)},Timer:function(b){return this instanceof a.Timer?(this.name=b||"Timer_instance_"+Date.now(),this):new a.Timer(b)},Logger:function(b,c){return this instanceof a.Logger?(this.level=void 0!==b?b:2,c&&(this.name=c),this.traceAnonymous=!1,this):new a.Logger(b,c)}}}();return a.Selector.prototype={hasClass:function(b){return a.hasClass(this.el,b),this},addClass:function(b){return a.addClass(this.el,b),this},removeClass:function(b){return a.removeClass(this.el,b),this},prepend:function(){return a.prepend(this.el),this},append:function(){return a.append(this.el),this},html:function(b){return a.html(this.el,b),this},parent:function(){return a.parent(this.el),this},children:function(){return a.children(this.el),this},css:function(){var b=[this.el];return Array.prototype.push.apply(b,arguments),a.css.apply(null,b),this}},a.Handler.prototype={on:function(a,b){return void 0===this.handlers[a]&&(this.handlers[a]=[]),this.handlers[a].push(b),this},removeAll:function(){this.handlers={}},remove:function(a){void 0!==this.handlers[a]&&(this.handlers[a].length=0)},off:function(a){this.remove(a)},executeHandler:function(a){for(var b=this.handlers[a]||[],c=0,d=b.length;d>c;c++)b[c].apply(this.context,[]);return this},exec:function(a){return this.executeHandler(a)},trigger:function(a){return this.executeHandler(a)},registerCallbacks:function(a){var b=this,c={};if(void 0!==a)for(c in a)a.hasOwnProperty(c)&&b.on(c,a[c]);return b},toString:function(){return"[Handler ' "+this+" ']"}},a.Timer.prototype=function(){var a,b,c;return{start:function(){a=Date.now()},stop:function(){return b=Date.now(),c=b-a},end:function(){return this.stop(),this.log(),c},log:function(){console.log(this.name+" "+c)}}}(),a.Logger.prototype=function(){function b(b,c,f,j){if(!(-1===b.level||c<b.level||b.level>5)){j=h.call(j);var k="%s%s",l=[];if(g)"string"===a.typeof(j[0])&&j[0].match(/\%(s|j|d)/g)&&(k+=j.shift()),l.unshift(k,d(b),e(c));else{k="%c%s%c%s%c%s","string"===a.typeof(j[0])&&j[0].match(/\%(c|s|o|O|d|i|f)/g)&&(k+=j.shift()),f=""===f.replace(/\s+/,"")?"":f+" 	";var m="color:"+_colors[c]+";",n="color:purple",o="color:black";l=[k,n,d(b),m,e(c),o,f]}switch(i.apply(l,j),c){case-1:return;case 0:console.log(arguments[3]);break;case 2:console.log.apply(console,l);break;default:try{console[_levels[c]].apply(console,l)}catch(p){console.log("[Logger (recovery mode)] ",l)}}}}function c(a){var b=a.callee.caller.name;return!b&&this.traceAnonymous?"<anonymous> "+a.callee.caller+"\n":b}function d(a){var b=a.name||"";return j?j.magenta(b):b}function e(a){return f(a," "+_levels[a].toUpperCase()+" ")+f(6,"["+(new Date).toLocaleTimeString()+"] ")}function f(a,b){return j?j[_colors[a]](b):b}var g="object"==typeof exports,h=Array.prototype.slice,i=Array.prototype.push,j=g?require("chalk"):null;return _levels=["dummy","trace","debug","info","warn","error"],_colors=["gray","gray","green",g?"cyan":"blue",g?"yellow":"darkorange","red","gray"],{log:function(){b(this,0,c(arguments),arguments)},trace:function(){b(this,1,c(arguments),arguments)},debug:function(){b(this,2,c(arguments),arguments)},info:function(){b(this,3,c(arguments),arguments)},warn:function(){b(this,4,c(arguments),arguments)},error:function(){b(this,5,c(arguments),arguments)}}}(),a});